{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/home/ujjwal/Desktop/Imgur/client/src/components/auth/AuthState.js\",\n    _s = $RefreshSig$();\n\nimport { useReducer } from \"react\";\nimport axios from 'axios';\nimport AuthContext from \"./AuthContext\";\nimport AuthReducer from \"./AuthReducer\";\nimport AuthToken from './TokenAuth';\nimport { REGISTER_USER, LOAD_USER, LOGIN_USER, LOGOUT, REGISTRATION_FAILED, LOGIN_FAILED } from \"../image/action\";\n\nconst AuthState = props => {\n  _s();\n\n  const initialState = {\n    token: localStorage.getItem('token'),\n    isAuthenticated: null,\n    user: null,\n    loading: true,\n    error: null\n  };\n  const [state, dispatch] = useReducer(AuthReducer, initialState); // load useraccount\n\n  const loadUser = async () => {\n    if (localStorage.token) {\n      AuthToken(localStorage.token);\n    }\n\n    try {\n      const res = await axios.get('/api/login');\n      dispatch({\n        type: LOAD_USER,\n        payload: res.data\n      });\n      loadUser();\n    } catch (error) {\n      console.log(error);\n    }\n  }; // Register user\n\n\n  const registeruser = async formData => {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    };\n\n    try {\n      const res = await axios.post('/api/users', formData, config);\n      dispatch({\n        type: REGISTER_USER,\n        payload: res.data\n      });\n    } catch (error) {\n      dispatch({\n        type: REGISTRATION_FAILED,\n        payload: error.resposne.data.msg\n      });\n    }\n  };\n\n  const loginuser = async formData => {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    };\n\n    try {\n      const res = await axios.post('/api/auth', formData, config);\n      dispatch({\n        type: LOGIN_USER,\n        payload: res.data\n      });\n    } catch (error) {\n      dispatch({\n        type: LOGIN_FAILED,\n        payload: error.resposne.data.msg\n      });\n    }\n  };\n\n  const logout = () => {\n    dispatch({\n      type: LOGOUT\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      token: state.token,\n      isAuthenticated: state.isAuthenticated,\n      loading: state.loading,\n      user: state.user,\n      error: state.error,\n      registeruser,\n      loadUser,\n      loginuser,\n      logout\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 8\n  }, this);\n};\n\n_s(AuthState, \"UrEkDPQH5U12xnblC9PjDJeyoVE=\");\n\n_c = AuthState;\nexport default AuthState;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthState\");","map":{"version":3,"sources":["/home/ujjwal/Desktop/Imgur/client/src/components/auth/AuthState.js"],"names":["useReducer","axios","AuthContext","AuthReducer","AuthToken","REGISTER_USER","LOAD_USER","LOGIN_USER","LOGOUT","REGISTRATION_FAILED","LOGIN_FAILED","AuthState","props","initialState","token","localStorage","getItem","isAuthenticated","user","loading","error","state","dispatch","loadUser","res","get","type","payload","data","console","log","registeruser","formData","config","headers","post","resposne","msg","loginuser","logout","children"],"mappings":"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","sourcesContent":["import { useReducer } from \"react\";\nimport axios from 'axios';\nimport AuthContext from \"./AuthContext\";\nimport AuthReducer from \"./AuthReducer\";\nimport AuthToken from './TokenAuth';\nimport {\n    REGISTER_USER,\n    LOAD_USER,\n    LOGIN_USER,\n    LOGOUT,\n    REGISTRATION_FAILED,\n    LOGIN_FAILED\n} from \"../image/action\";\n\nconst AuthState = (props) => {\n    const initialState={\n        token: localStorage.getItem('token'),\n        isAuthenticated: null,\n        user:null,\n        loading: true,\n        error:null\n         \n    }\n   const [state,dispatch]=useReducer(AuthReducer,initialState);\n   // load useraccount\n\n   const loadUser=async()=>{\n       if(localStorage.token){\n           AuthToken(localStorage.token);\n       }\n       try {\n           const res=await axios.get('/api/login')\n           dispatch({\n               type:LOAD_USER,\n               payload:res.data\n           })\n           loadUser();\n       } catch (error) {\n           console.log(error);\n       }\n   }\n    // Register user\n    const registeruser=async formData=>{\n        const config={\n            headers:{\n               'Content-Type':'application/json'\n            }\n        }\n        try {\n            const res=await axios.post('/api/users',formData,config);\n            dispatch({\n                type:REGISTER_USER,\n                payload:res.data\n            })\n        } catch (error) {\n            dispatch({\n                type:REGISTRATION_FAILED,\n                payload:error.resposne.data.msg\n            })\n        }\n    }\n\n    const loginuser=async formData=>{\n        const config={\n            headers:{\n               'Content-Type':'application/json'\n            }\n        }\n        try {\n            const res=await axios.post('/api/auth',formData,config);\n            dispatch({\n                type:LOGIN_USER,\n                payload:res.data\n            })\n        } catch (error) {\n            dispatch({\n                type:LOGIN_FAILED,\n                payload:error.resposne.data.msg\n            })\n        }\n    }\n    const logout= ()=>{\n        dispatch({type:LOGOUT});\n    }\n\n\n   return(\n       <AuthContext.Provider value={{\n           token:state.token,\n           isAuthenticated:state.isAuthenticated,\n           loading:state.loading,\n           user:state.user,\n           error:state.error,\n           registeruser,\n           loadUser,\n           loginuser,\n           logout\n       }}>\n        {props.children}   \n       </AuthContext.Provider>\n   );\n};\nexport default AuthState;"]},"metadata":{},"sourceType":"module"}